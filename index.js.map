{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nexport const querySearch = async (searchValue, page) => {\n  return axios.get(`https://pixabay.com/api/`, {\n    params: {\n      key: '48370446-8dcf2f9524038c25db09fe77e',\n      q: searchValue,\n      image_type: 'photo',\n      orientation: 'horizontal',\n      safesearch: true,\n      per_page: 15,\n      page,\n    },\n  });\n\n  // .then(response => {\n  //   if (!response.ok) {\n  //     throw new Error(response.status);\n  //   }\n  //   // console.log(\n  //   //   response.json().then(res => {\n  //   //     console.log(res.hits);\n  //   //   })\n  //   // );\n  //   return response.json();\n  // });\n};\n\n// export const querySearch = searchValue => {\n//   return fetch(\n//     `https://pixabay.com/api/?key=48370446-8dcf2f9524038c25db09fe77e&q=${searchValue}&image_type=photo&orientation=horizontal&safesearch=true&per_page=30`\n//   ).then(response => {\n//     if (!response.ok) {\n//       throw new Error(response.status);\n//     }\n//     // console.log(\n//     //   response.json().then(res => {\n//     //     console.log(res.hits);\n//     //   })\n//     // );\n//     return response.json();\n//   });\n// };\n","export const createMarkUp = imgINfo => {\n  return `<li class='js-gallery-item'>\n  <a class=\"query-image-big\" href=\"${imgINfo.largeImageURL}\">\n    <img\n      class=\"query-image\"\n      src=\"${imgINfo.webformatURL}\"\n      alt=\"${imgINfo.tags}\"\n    />\n    <ul class=\"gallery-details\">\n      <li class=\"gallery-details-section\">\n        <h3 class=\"gallery-details-heading\">Likes</h3>\n        <p class=\"gallery-details-text\">${imgINfo.likes}</p>\n      </li>\n      <li>\n        <h3 class=\"gallery-details-heading\">Views</h3>\n        <p class=\"gallery-details-text\">${imgINfo.views}</p>\n      </li>\n      <li>\n        <h3 class=\"gallery-details-heading\">Comments</h3>\n        <p class=\"gallery-details-text\">${imgINfo.comments}</p>\n      </li>\n      <li>\n        <h3 class=\"gallery-details-heading\">Downloads</h3>\n        <p class=\"gallery-details-text\">${imgINfo.downloads}</p>\n      </li>\n    </ul>\n  </a>\n</li>`;\n};\n","//imports from other files\nimport { querySearch } from './js/pixabay-api';\nimport { createMarkUp } from './js/render-functions';\n\n//imports of libraries\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\n//get the elements from page\nconst searchFormEl = document.querySelector('.js-search-form');\nconst gallery = document.querySelector('.js-gallery');\nconst loader = document.querySelector('.loader');\nconst showMoreBtn = document.querySelector('.js-show-more-btn');\n\n//global variables for fetch\nlet page = 1;\nlet searchedQuery = '';\n\n//the event of submited form\nconst onSearchFormSumbit = async event => {\n  try {\n    event.preventDefault();\n    //grt + check the entered value\n    searchedQuery = event.currentTarget.elements.user_query.value.trim();\n\n    if (searchedQuery === '') {\n      iziToast.show({\n        message: 'Input has to be filled!',\n        color: 'red',\n        position: 'bottomLeft',\n      });\n      return;\n    }\n\n    //show the loading sign\n    loader.style.visibility = 'visible';\n\n    //set page to 1 in case of changed input\n    page = 1;\n\n    //start the search of the query\n    const { data } = await querySearch(searchedQuery, page);\n\n    //check if the query is valid\n    if (data.total === 0) {\n      iziToast.show({\n        message:\n          'Sorry, there are no images matching your search query. Please try again!',\n        color: 'red',\n        position: 'bottomLeft',\n      });\n\n      searchFormEl.reset();\n\n      //clean the gallry, hide loader and button\n      gallery.innerHTML = '';\n\n      loader.style.visibility = 'hidden';\n      showMoreBtn.classList.add('is-hidden');\n\n      return;\n    }\n\n    //check if there are more images to show the \"more\" button\n    if (data.totalHits > page * 15) {\n      console.log('asas');\n      showMoreBtn.classList.remove('is-hidden');\n      showMoreBtn.addEventListener('click', onShowMoreClick);\n    }\n\n    //output the results to the page, refresh the input and lightbox\n    const galleryTemplate = data.hits.map(el => createMarkUp(el)).join('');\n    gallery.innerHTML = galleryTemplate;\n\n    searchFormEl.reset();\n    lightbox.refresh();\n\n    loader.style.visibility = 'hidden';\n  } catch (error) {\n    //in case of any errors\n    loader.style.visibility = 'hidden';\n    console.log(error);\n  }\n};\nsearchFormEl.addEventListener('submit', onSearchFormSumbit);\n\n//show the bigger version of a photo\nlet lightbox = new SimpleLightbox('.query-image-big', {\n  captions: true,\n  captionsData: 'alt',\n  captionDelay: 250,\n});\n\nconst onShowMoreClick = async () => {\n  try {\n    //elements for scrolling the page\n    const card = document.querySelector('.js-gallery-item');\n    const sizeToScroll = card.getBoundingClientRect().height;\n\n    window.scrollBy({\n      top: sizeToScroll * 2,\n      behavior: 'smooth',\n    });\n    //show loader, change page to next to show next images, hide button\n    loader.style.visibility = 'visible';\n    page++;\n    showMoreBtn.classList.add('is-hidden');\n\n    //getting another set of photos, adding to the page\n    const { data } = await querySearch(searchedQuery, page);\n    const galleryTemplate = data.hits.map(el => createMarkUp(el)).join('');\n    gallery.insertAdjacentHTML('beforeend', galleryTemplate);\n\n    loader.style.visibility = 'hidden';\n\n    lightbox.refresh();\n\n    //check if this is the last set of photos\n    if (data.totalHits < page * 15) {\n      showMoreBtn.classList.add('is-hidden');\n\n      iziToast.show({\n        message: \"We're sorry, but you've reached the end of search results.\",\n        color: 'blue',\n        position: 'topRight',\n      });\n      showMoreBtn.removeEventListener('click', onShowMoreClick);\n\n      return;\n    }\n    showMoreBtn.classList.remove('is-hidden');\n  } catch (error) {\n    console.log(error);\n    showMoreBtn.classList.add('is-hidden');\n  }\n};\n"],"names":["querySearch","searchValue","page","axios","createMarkUp","imgINfo","searchFormEl","gallery","loader","showMoreBtn","searchedQuery","onSearchFormSumbit","event","iziToast","data","onShowMoreClick","galleryTemplate","el","lightbox","error","SimpleLightbox","sizeToScroll"],"mappings":"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"}